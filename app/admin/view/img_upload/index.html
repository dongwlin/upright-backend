<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Upload</title>
    <link rel="stylesheet" href="/static/css/fileUpload.css">
</head>

<body>
<div class="flex items-center justify-center w-full bg-emerald-300 h-12 mb-8 relative">
    <div class="absolute left-0 px-4 hover:bg-emerald-400 h-12 flex justify-center items-center"
         onclick="location.href='/admin'">
        <img
                src="data:image/svg+xml,%3Csvg%20t%3D%221692264327455%22%20class%3D%22icon%22%20viewBox%3D%220%200%201024%201024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20p-id%3D%2212850%22%20width%3D%2232%22%20height%3D%2232%22%3E%3Cpath%20d%3D%22M96%20480c-9.6%200-19.2-3.2-25.6-12.8-12.8-12.8-9.6-35.2%203.2-44.8l377.6-310.4c35.2-25.6%2086.4-25.6%20118.4%200l377.6%20307.2c12.8%209.6%2016%2032%203.2%2044.8-12.8%2012.8-32%2016-44.8%203.2L531.2%20166.4c-9.6-6.4-28.8-6.4-38.4%200L115.2%20473.6c-6.4%206.4-12.8%206.4-19.2%206.4zM816%20928H608c-19.2%200-32-12.8-32-32v-150.4c0-22.4-38.4-44.8-67.2-44.8-28.8%200-64%2019.2-64%2044.8V896c0%2019.2-12.8%2032-32%2032H211.2C163.2%20928%20128%20892.8%20128%20848V544c0-19.2%2012.8-32%2032-32s32%2012.8%2032%2032v304c0%209.6%206.4%2016%2019.2%2016H384v-118.4c0-64%2067.2-108.8%20128-108.8s131.2%2044.8%20131.2%20108.8V864h176c9.6%200%2016%200%2016-19.2V544c0-19.2%2012.8-32%2032-32s32%2012.8%2032%2032v304C896%20896%20864%20928%20816%20928z%22%20fill%3D%22%23ffffff%22%20p-id%3D%2212851%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E"
                alt="home">
    </div>
    <div class="text-lg font-bold text-gray-700">Image Upload</div>
</div>
<div>
    <div id="imgPreBox" class="flex justify-center items-center w-2/3 h-96 mx-auto bg-slate-100 rounded-md p-4">
        <img class="max-h-full"
             src="data:image/svg+xml,%3Csvg%20t%3D%221692259178497%22%20class%3D%22icon%22%20viewBox%3D%220%200%201024%201024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20p-id%3D%2211712%22%20width%3D%22200%22%20height%3D%22200%22%3E%3Cpath%20d%3D%22M913.212778%20864.677365l0-66.940598%2016.738219%200%200%2066.940598L913.212778%20864.677365%20913.212778%20864.677365%20913.212778%20864.677365zM913.212778%20764.263397l0-66.946738%2016.738219%200%200%2066.946738L913.212778%20764.263397%20913.212778%20764.263397%20913.212778%20764.263397zM913.212778%20596.903715l16.738219%200%200%2066.946738L913.212778%20663.850453%20913.212778%20596.903715%20913.212778%20596.903715%20913.212778%20596.903715zM913.212778%20496.487701l16.738219%200%200%2066.942645L913.212778%20563.430346%20913.212778%20496.487701%20913.212778%20496.487701%20913.212778%20496.487701zM913.212778%20396.068617%20913.212778%20396.068617l16.738219%200%200%2066.940598L913.212778%20463.009216%20913.212778%20396.068617%20913.212778%20396.068617%20913.212778%20396.068617zM913.212778%20295.65465l16.738219%200%200%2066.940598L913.212778%20362.595248%20913.212778%20295.65465%20913.212778%20295.65465%20913.212778%20295.65465zM913.212778%20195.234543%20913.212778%20195.234543l16.738219%200%200%2066.946738L913.212778%20262.181281%20913.212778%20195.234543%20913.212778%20195.234543%20913.212778%20195.234543zM913.212778%2094.820576l16.738219%200%200%2066.940598L913.212778%20161.761174%20913.212778%2094.820576%20913.212778%2094.820576%20913.212778%2094.820576zM829.525774%2094.820576l66.946738%200%200%2016.739243-66.946738%200L829.525774%2094.820576%20829.525774%2094.820576%20829.525774%2094.820576zM729.111806%2094.820576l66.946738%200%200%2016.739243-66.946738%200L729.111806%2094.820576%20729.111806%2094.820576%20729.111806%2094.820576zM628.697839%2094.820576l66.940598%200%200%2016.739243-66.940598%200L628.697839%2094.820576%20628.697839%2094.820576%20628.697839%2094.820576zM528.283872%2094.820576l66.940598%200%200%2016.739243-66.940598%200L528.283872%2094.820576%20528.283872%2094.820576%20528.283872%2094.820576zM427.862741%2094.820576l66.947761%200%200%2016.739243-66.947761%200L427.862741%2094.820576%20427.862741%2094.820576%20427.862741%2094.820576zM327.448774%2094.820576l66.946738%200%200%2016.739243-66.946738%200L327.448774%2094.820576%20327.448774%2094.820576%20327.448774%2094.820576zM227.02969%2094.820576l66.946738%200%200%2016.739243-66.946738%200L227.02969%2094.820576%20227.02969%2094.820576%20227.02969%2094.820576zM126.615723%2094.820576l66.940598%200%200%2016.739243-66.940598%200L126.615723%2094.820576%20126.615723%2094.820576%20126.615723%2094.820576zM126.615723%20931.624103l-33.473369%200%200-33.473369%2016.738219%200%200%2016.739243%2016.734126%200L126.614699%20931.624103%20126.615723%20931.624103%20126.615723%20931.624103zM93.142353%20797.736766l16.738219%200%200%2066.940598-16.738219%200L93.142353%20797.736766%2093.142353%20797.736766%2093.142353%20797.736766zM93.142353%20697.317683l16.738219%200%200%2066.946738-16.738219%200L93.142353%20697.317683%2093.142353%20697.317683%2093.142353%20697.317683zM93.142353%20596.903715l16.738219%200%200%2066.946738-16.738219%200L93.142353%20596.903715%2093.142353%20596.903715%2093.142353%20596.903715zM93.142353%20496.487701l16.738219%200%200%2066.942645-16.738219%200L93.142353%20496.487701%2093.142353%20496.487701%2093.142353%20496.487701zM93.142353%20396.068617l16.738219%200%200%2066.940598-16.738219%200L93.142353%20396.068617%2093.142353%20396.068617%2093.142353%20396.068617zM93.142353%20295.65465l16.738219%200%200%2066.940598-16.738219%200L93.142353%20295.65465%2093.142353%20295.65465%2093.142353%20295.65465zM93.142353%20195.234543%2093.142353%20195.234543l16.738219%200%200%2066.946738-16.738219%200L93.142353%20195.234543%2093.142353%20195.234543%2093.142353%20195.234543zM93.142353%2094.820576l16.738219%200%200%2066.940598-16.738219%200L93.142353%2094.820576%2093.142353%2094.820576%2093.142353%2094.820576zM227.02969%20931.624103l-66.940598%200L160.089092%20914.889977l66.940598%200L227.02969%20931.624103%20227.02969%20931.624103%20227.02969%20931.624103zM327.448774%20931.624103l-66.940598%200L260.508175%20914.889977l66.940598%200L327.448774%20931.624103%20327.448774%20931.624103%20327.448774%20931.624103zM486.442928%20345.862145l50.207495%200%200%20142.259004%20142.259004%200%200%2050.207495L536.650423%20538.328645l0%20142.253888L486.442928%20680.582533%20486.442928%20538.329668%20344.1829%20538.329668l0-50.207495L486.442928%20488.122173%20486.442928%20345.862145%20486.442928%20345.862145%20486.442928%20345.862145zM427.862741%20931.624103l-66.940598%200L360.922143%20914.889977l66.940598%200L427.862741%20931.624103%20427.862741%20931.624103%20427.862741%20931.624103zM528.283872%20931.624103l-66.946738%200L461.337133%20914.889977l66.946738%200L528.283872%20931.624103%20528.283872%20931.624103%20528.283872%20931.624103zM628.697839%20931.624103l-66.940598%200L561.757241%20914.889977l66.940598%200L628.697839%20931.624103%20628.697839%20931.624103%20628.697839%20931.624103zM729.111806%20931.624103l-66.940598%200L662.171208%20914.889977l66.940598%200L729.111806%20931.624103%20729.111806%20931.624103%20729.111806%20931.624103zM829.525774%20931.624103l-66.940598%200L762.585175%20914.889977l66.940598%200L829.525774%20931.624103%20829.525774%20931.624103%20829.525774%20931.624103zM913.212778%20898.150734l16.738219%200%200%2033.473369-66.946738%200L863.004259%20914.889977l50.207495%200L913.211754%20898.150734%20913.212778%20898.150734%20913.212778%20898.150734zM913.212778%20898.150734%22%20fill%3D%22%23dbdbdb%22%20p-id%3D%2211713%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E"
             alt="imgPre" id="imgPre">
    </div>
    <div class="w-full flex justify-center">
        <input
                class="w-2/3 p-4 mt-8 rounded-md drop-shadow-sm bg-slate-100 text-base focus:outline-none focus:shadow-md focus:bg-slate-200"
                type="text" name="imgUploadSrc" id="imgUploadSrcInput">
    </div>
    <div class="flex justify-center">
        <input class="hidden" type="file" name="image" id="imgInput">
        <label class="block w-48 p-4 m-8 rounded-md text-center bg-teal-400 hover:bg-teal-500 active:bg-teal-300"
               for="imgInput">select image</label>
        <button class="block w-48 p-4 m-8 rounded-md bg-teal-400 hover:bg-teal-500 active:bg-teal-300" id="uploadBtn"
                onclick="handleImgUpload()">upload</button>
        <button class="block w-48 p-4 m-8 rounded-md bg-teal-400 hover:bg-teal-500 active:bg-teal-300"
                onclick="copyImgSrc()">copy url</button>
    </div>
</div>
<script>
    const clearImgPre = () => {
        const imgPre = document.getElementById('imgPre');
        imgPre.src = 'data:image/svg+xml,%3Csvg%20t%3D%221692259178497%22%20class%3D%22icon%22%20viewBox%3D%220%200%201024%201024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20p-id%3D%2211712%22%20width%3D%22200%22%20height%3D%22200%22%3E%3Cpath%20d%3D%22M913.212778%20864.677365l0-66.940598%2016.738219%200%200%2066.940598L913.212778%20864.677365%20913.212778%20864.677365%20913.212778%20864.677365zM913.212778%20764.263397l0-66.946738%2016.738219%200%200%2066.946738L913.212778%20764.263397%20913.212778%20764.263397%20913.212778%20764.263397zM913.212778%20596.903715l16.738219%200%200%2066.946738L913.212778%20663.850453%20913.212778%20596.903715%20913.212778%20596.903715%20913.212778%20596.903715zM913.212778%20496.487701l16.738219%200%200%2066.942645L913.212778%20563.430346%20913.212778%20496.487701%20913.212778%20496.487701%20913.212778%20496.487701zM913.212778%20396.068617%20913.212778%20396.068617l16.738219%200%200%2066.940598L913.212778%20463.009216%20913.212778%20396.068617%20913.212778%20396.068617%20913.212778%20396.068617zM913.212778%20295.65465l16.738219%200%200%2066.940598L913.212778%20362.595248%20913.212778%20295.65465%20913.212778%20295.65465%20913.212778%20295.65465zM913.212778%20195.234543%20913.212778%20195.234543l16.738219%200%200%2066.946738L913.212778%20262.181281%20913.212778%20195.234543%20913.212778%20195.234543%20913.212778%20195.234543zM913.212778%2094.820576l16.738219%200%200%2066.940598L913.212778%20161.761174%20913.212778%2094.820576%20913.212778%2094.820576%20913.212778%2094.820576zM829.525774%2094.820576l66.946738%200%200%2016.739243-66.946738%200L829.525774%2094.820576%20829.525774%2094.820576%20829.525774%2094.820576zM729.111806%2094.820576l66.946738%200%200%2016.739243-66.946738%200L729.111806%2094.820576%20729.111806%2094.820576%20729.111806%2094.820576zM628.697839%2094.820576l66.940598%200%200%2016.739243-66.940598%200L628.697839%2094.820576%20628.697839%2094.820576%20628.697839%2094.820576zM528.283872%2094.820576l66.940598%200%200%2016.739243-66.940598%200L528.283872%2094.820576%20528.283872%2094.820576%20528.283872%2094.820576zM427.862741%2094.820576l66.947761%200%200%2016.739243-66.947761%200L427.862741%2094.820576%20427.862741%2094.820576%20427.862741%2094.820576zM327.448774%2094.820576l66.946738%200%200%2016.739243-66.946738%200L327.448774%2094.820576%20327.448774%2094.820576%20327.448774%2094.820576zM227.02969%2094.820576l66.946738%200%200%2016.739243-66.946738%200L227.02969%2094.820576%20227.02969%2094.820576%20227.02969%2094.820576zM126.615723%2094.820576l66.940598%200%200%2016.739243-66.940598%200L126.615723%2094.820576%20126.615723%2094.820576%20126.615723%2094.820576zM126.615723%20931.624103l-33.473369%200%200-33.473369%2016.738219%200%200%2016.739243%2016.734126%200L126.614699%20931.624103%20126.615723%20931.624103%20126.615723%20931.624103zM93.142353%20797.736766l16.738219%200%200%2066.940598-16.738219%200L93.142353%20797.736766%2093.142353%20797.736766%2093.142353%20797.736766zM93.142353%20697.317683l16.738219%200%200%2066.946738-16.738219%200L93.142353%20697.317683%2093.142353%20697.317683%2093.142353%20697.317683zM93.142353%20596.903715l16.738219%200%200%2066.946738-16.738219%200L93.142353%20596.903715%2093.142353%20596.903715%2093.142353%20596.903715zM93.142353%20496.487701l16.738219%200%200%2066.942645-16.738219%200L93.142353%20496.487701%2093.142353%20496.487701%2093.142353%20496.487701zM93.142353%20396.068617l16.738219%200%200%2066.940598-16.738219%200L93.142353%20396.068617%2093.142353%20396.068617%2093.142353%20396.068617zM93.142353%20295.65465l16.738219%200%200%2066.940598-16.738219%200L93.142353%20295.65465%2093.142353%20295.65465%2093.142353%20295.65465zM93.142353%20195.234543%2093.142353%20195.234543l16.738219%200%200%2066.946738-16.738219%200L93.142353%20195.234543%2093.142353%20195.234543%2093.142353%20195.234543zM93.142353%2094.820576l16.738219%200%200%2066.940598-16.738219%200L93.142353%2094.820576%2093.142353%2094.820576%2093.142353%2094.820576zM227.02969%20931.624103l-66.940598%200L160.089092%20914.889977l66.940598%200L227.02969%20931.624103%20227.02969%20931.624103%20227.02969%20931.624103zM327.448774%20931.624103l-66.940598%200L260.508175%20914.889977l66.940598%200L327.448774%20931.624103%20327.448774%20931.624103%20327.448774%20931.624103zM486.442928%20345.862145l50.207495%200%200%20142.259004%20142.259004%200%200%2050.207495L536.650423%20538.328645l0%20142.253888L486.442928%20680.582533%20486.442928%20538.329668%20344.1829%20538.329668l0-50.207495L486.442928%20488.122173%20486.442928%20345.862145%20486.442928%20345.862145%20486.442928%20345.862145zM427.862741%20931.624103l-66.940598%200L360.922143%20914.889977l66.940598%200L427.862741%20931.624103%20427.862741%20931.624103%20427.862741%20931.624103zM528.283872%20931.624103l-66.946738%200L461.337133%20914.889977l66.946738%200L528.283872%20931.624103%20528.283872%20931.624103%20528.283872%20931.624103zM628.697839%20931.624103l-66.940598%200L561.757241%20914.889977l66.940598%200L628.697839%20931.624103%20628.697839%20931.624103%20628.697839%20931.624103zM729.111806%20931.624103l-66.940598%200L662.171208%20914.889977l66.940598%200L729.111806%20931.624103%20729.111806%20931.624103%20729.111806%20931.624103zM829.525774%20931.624103l-66.940598%200L762.585175%20914.889977l66.940598%200L829.525774%20931.624103%20829.525774%20931.624103%20829.525774%20931.624103zM913.212778%20898.150734l16.738219%200%200%2033.473369-66.946738%200L863.004259%20914.889977l50.207495%200L913.211754%20898.150734%20913.212778%20898.150734%20913.212778%20898.150734zM913.212778%20898.150734%22%20fill%3D%22%23dbdbdb%22%20p-id%3D%2211713%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E';
    }
    const imgInput = document.getElementById('imgInput');
    imgInput.addEventListener('change', event => {
        const selectFile = event.target.files[0];
        if (selectFile.type.startsWith('image/')) {
            const reader = new FileReader();
            const imgBox = document.getElementById('imgPre');
            reader.onload = e => {
                imgBox.src = e.target.result;
            }
            reader.readAsDataURL(selectFile);
        }
        else {
            clearImgPre();
            const imgInput = document.getElementById('imgInput');
            imgInput.value = '';
            alert('This type of file is not supported.');
        }
    })

    const handleImgUpload = () => {
        const imgInput = document.getElementById('imgInput');
        if (imgInput.files.length <= 0) {
            alert('No file is selected.');
            return;
        }
        let file = imgInput.files[0];
        const formData = new FormData();
        formData.append('image', file);
        fetch('img-upload/upload', {
            method: 'POST',
            body: formData
        })
            .then(res => res.json())
            .catch(err => console.error('Error: ' + err))
            .then(res => {
                if (res.code === 201) {
                    const imgUploadSrcInput = document.getElementById('imgUploadSrcInput');
                    imgUploadSrcInput.value = res.data.imgSrc;
                }
                else if (res.code === 400) {
                    alert(res.msg);
                }
                else {
                    console.log(res);
                }
            });
        clearImgPre();
        imgInput.value = '';
    }

    const copyImgSrc = () => {
        const imgUploadSrcInput = document.getElementById('imgUploadSrcInput');
        if (imgUploadSrcInput.value === '') {
            return;
        }
        try {
            navigator.clipboard.writeText(imgUploadSrcInput.value)
                .then(() => {
                    console.log('success.');
                })
                .catch(e=> {
                    alert('This feature is available only in secure contexts (HTTPS), in some or all supporting browsers.');
                    console.error('error: ', e);
                });
        }
        catch (e) {
            alert('This feature is available only in secure contexts (HTTPS), in some or all supporting browsers.');
            console.error(e);
        }
    }
</script>
</body>

</html>